<!DOCTYPE html>
<html>
<head>
  <title>Hours - The True Tutor</title>
  <style>
    .form-field {
      display: flex;
      align-items: center;
      margin-bottom: 1px;
    }

    .form-field label {
      width: 150px;
      font-weight: bold;
      margin-right: 40px;
    }

    body {
      font-family: Arial, sans-serif;
      background: url('Backround.png') no-repeat center center fixed; 
      background-size: cover;
      padding: 40px;
    }
    h1 {
      text-align: center;
    }
    table {
      width: 100%;
      border: 3px solid black;
      margin-top: 20px;
      background: white;
    }
    th, td {
      padding: 12px;
      border: 1px solid #ddd;
      text-align: center;
    }
    form {
      background: white;
      padding: 20px;
      margin-top: 30px;
      border: 3px solid black;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    label {
      margin-right: 10px;
    }
    input {
      margin: 5px;
      padding: 8px;
    }
    button {
      padding: 10px 20px;
      margin-top: 10px;
      background: #111;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 5px;
    }
    button:hover {
      background: #333;
    }
  </style>
</head>
<body>

<form id="add-form">
  <h2>Log Hours</h2>
  <div class="form-field">
    <label>Date:</label>
    <input type="date" id="Date" required style="width: 300px;">
  </div>
  <div class="form-field">
    <label>Student Name:</label>
    <input type="text" id="StudentName" required style="width: 300px;">
  </div>
  <div class="form-field">
    <label>Subject:</label>
    <input type="text" id="Subject" required style="width: 300px;">
  </div>
  <div class="form-field">
    <label>Grade:</label>
    <input type="text" id="Grade" required style="width: 300px;">
  </div>
  <div class="form-field">
    <label>Travel Fee:</label>
    <input type="number" step="0.01" id="TravelFee" required style="width: 300px;">
  </div>
  <div class="form-field">
    <label>Number of Hours:</label>
    <input type="number" step="0.01" id="NoOfHours" required style="width: 300px;">
  </div>
  <div class="form-field">
    <label>Rate:</label>
    <input type="number" step="0.01" id="Rate" required style="width: 300px;">
  </div>
  <button type="submit">Add Entry</button>
</form>

<table id="hours-table">
  <thead>
    <tr>
      <th colspan="8" style="text-align: left; font-size: 24px; padding: 10px;">Logged Hours</th>
    </tr>
    <tr>
      <th>Date</th>
      <th>Student Name</th>
      <th>Subject</th>
      <th>Grade</th>
      <th>Travel Fee</th>
      <th>No. of Hours</th>
      <th>Rate</th>
      <th>Delete</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
  const TutorID = localStorage.getItem('TutorID');
  const tableBody = document.querySelector('#hours-table tbody');

  // if (!TutorID) {
  //   alert("No TutorID found. Please log in again.");
  //   window.location.href = "index.html";
  // }

function fetchHours() {
  fetch(`auth.php?action=get_hours&TutorID=${TutorID}`)
    .then(res => res.json())
    .then(data => {
      tableBody.innerHTML = '';
      data.forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${row.Lesson_Date}</td>
          <td>${row.Student_Name_Surname}</td>
          <td>${row.Subject}</td>
          <td>${row.Grade}</td>
          <td>${row.Travel_Fee}</td>
          <td>${row.Number_Hours}</td>
          <td>${row.Rate_Hour}</td>
          <td><button onclick="deleteRow(${row.id})">Delete</button></td>
        `;
        tableBody.appendChild(tr);
      });
    })
    .catch(err => alert('Error fetching hours: ' + err.message));
}

document.getElementById('add-form').addEventListener('submit', e => {
  e.preventDefault();

  const newRecord = {
    TutorID,
    Date: document.getElementById('Date').value,
    StudentName: document.getElementById('StudentName').value,
    Subject: document.getElementById('Subject').value,
    Grade: document.getElementById('Grade').value,
    TravelFee: parseInt(document.getElementById('TravelFee').value, 10),
    NoOfHours: parseInt(document.getElementById('NoOfHours').value, 10),
    Rate: parseInt(document.getElementById('Rate').value, 10),
  };

  fetch('auth.php?action=add_hour', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(newRecord)
  })
  .then(res => res.json())
  .then(() => {
    e.target.reset();
    fetchHours();
  })
  .catch(err => alert('Error adding entry: ' + err.message));
});


  fetchHours();
</script>

</body>
</html>
